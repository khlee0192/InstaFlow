
  0%|                                                                                                                                                                                                                                                                                     | 0/100 [00:00<?, ?it/s]/home/icl2/anaconda3/lib/python3.10/site-packages/torch/cuda/memory.py:330: FutureWarning: torch.cuda.reset_max_memory_allocated now calls torch.cuda.reset_peak_memory_stats, which resets /all/ peak memory stats.
  warnings.warn(
0, 0.11795724928379059
1, 0.11795724928379059
2, 0.11739067733287811
3, 0.11626206338405609
4, 0.11457620561122894
5, 0.1123458668589592
6, 0.10958494246006012
7, 0.10631006956100464
8, 0.10255119204521179
9, 0.09833520650863647
10, 0.09369975328445435
11, 0.0886923298239708
12, 0.08395978063344955
13, 0.07971377670764923
14, 0.07610564678907394
15, 0.07322029024362564
16, 0.07107260823249817
17, 0.06961862742900848
18, 0.06876593828201294
19, 0.06837549060583115
0 3.03125 0.05 6.140625
1 2.861328125 0.05 5.47265625
2 2.693359375 0.05 4.8515625
3 2.505859375 0.05 4.19921875
4 2.21484375 0.05 3.283203125
5 1.80078125 0.05 2.16796875
6 1.3525390625 0.05 1.224609375
7 0.9892578125 0.05 0.65478515625
8 0.76220703125 0.05 0.388916015625
9 0.6015625 0.05 0.2421875
10 0.50927734375 0.05 0.173583984375
11 0.452880859375 0.05 0.1370849609375
12 0.387451171875 0.05 0.1004638671875
13 0.360107421875 0.05 0.08673095703125
14 0.31884765625 0.05 0.06793212890625
15 0.302978515625 0.05 0.061431884765625
16 0.27392578125 0.05 0.050201416015625
17 0.25927734375 0.05 0.04498291015625
18 0.24072265625 0.05 0.03875732421875
19 0.229248046875 0.05 0.035186767578125
20 0.21630859375 0.05 0.031280517578125
21 0.2078857421875 0.05 0.0289154052734375
22 0.1990966796875 0.05 0.026519775390625
23 0.1934814453125 0.05 0.0250396728515625
24 0.1898193359375 0.05 0.02410888671875
25 0.1864013671875 0.05 0.0232391357421875
26 0.1898193359375 0.05 0.0241241455078125
27 0.1885986328125 0.05 0.0237884521484375
28 0.1995849609375 0.05 0.0266265869140625
29 0.2001953125 0.05 0.02679443359375
30 0.20263671875 0.05 0.0274810791015625
31 0.200439453125 0.05 0.02685546875
32 0.19775390625 0.05 0.0261688232421875
33 0.1953125 0.05 0.0255279541015625
  0%|                                                                                                                                                                                                                                                                                     | 0/100 [00:27<?, ?it/s]
Error in sys.excepthook:
Traceback (most recent call last):
  File "/home/icl2/anaconda3/lib/python3.10/linecache.py", line 46, in getlines
    return updatecache(filename, module_globals)
  File "/home/icl2/anaconda3/lib/python3.10/linecache.py", line 136, in updatecache
    with tokenize.open(fullname) as fp:
  File "/home/icl2/anaconda3/lib/python3.10/tokenize.py", line 396, in open
    encoding, lines = detect_encoding(buffer.readline)
  File "/home/icl2/anaconda3/lib/python3.10/tokenize.py", line 365, in detect_encoding
    first = read_or_stop()
  File "/home/icl2/anaconda3/lib/python3.10/tokenize.py", line 323, in read_or_stop
    return readline()
KeyboardInterrupt
Original exception was:
Traceback (most recent call last):
  File "/home/icl2/khlee/InstaFlow/code/main_new_algorithm.py", line 241, in <module>
    main()
  File "/home/icl2/khlee/InstaFlow/code/main_new_algorithm.py", line 180, in main
    original_image, recon_image, diff_image, original_latents_visualized, recon_latents_visualized, diff_latents_visualized, error_TOT, error_OTO, error_middle, output_loss, peak_gpu_allocated, inf_time, inv_time, seed = single_exp(seed, prompt, inversion_prompt,
  File "/home/icl2/anaconda3/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/icl2/khlee/InstaFlow/code/main_new_algorithm.py", line 47, in single_exp
    recon_images, recon_zo, recon_latents, output_loss, peak_gpu_allocated, dec_inv_time = insta_pipe.exact_inversion(
  File "/home/icl2/khlee/InstaFlow/code/pipeline_rf.py", line 1012, in exact_inversion
  File "/home/icl2/anaconda3/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/icl2/khlee/InstaFlow/code/pipeline_rf.py", line 1256, in forward_step_method
    step_size = step_scheduler.step(loss)
  File "/home/icl2/khlee/InstaFlow/code/pipeline_rf.py", line 1716, in step
    current = float(metrics)
KeyboardInterrupt
34 0.1986083984375 0.05 0.026397705078125
35 0.1998291015625 0.05 0.026702880859375
36 0.198974609375 0.05 0.026458740234375
37 0.1983642578125 0.05 0.0263214111328125
38 0.198974609375 0.05 0.0264892578125
39 0.2008056640625 0.05 0.026947021484375
40 0.2008056640625 0.05 0.0269622802734375
41 0.2022705078125 0.025 0.027374267578125
42 0.202392578125 0.025 0.0273895263671875
43 0.130615234375 0.025 0.01140594482421875
44 0.12152099609375 0.025 0.00988006591796875