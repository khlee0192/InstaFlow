
  0%|                                                                                                                       | 0/10 [00:00<?, ?it/s]
0, 0.1364392638206482
1, 0.1364392638206482
2, 0.12979209423065186
3, 0.11694800108671188
4, 0.09893600642681122
5, 0.07756024599075317
6, 0.055496156215667725
7, 0.038771919906139374
8, 0.02704126015305519
9, 0.019482754170894623
10, 0.01502986066043377
11, 0.01263423077762127
12, 0.011445599608123302
13, 0.010869039222598076
14, 0.01053331233561039
15, 0.010230299085378647
16, 0.009859224781394005
17, 0.009386738762259483
18, 0.008824300020933151
19, 0.008198825642466545
20, 0.0075437286868691444
21, 0.0068910433910787106
22, 0.006270015146583319
23, 0.005704865790903568
24, 0.005210265517234802
25, 0.0047903480008244514
26, 0.0044431136921048164
27, 0.004161518067121506
28, 0.003934572450816631
29, 0.0037490285467356443
30, 0.0035919733345508575
31, 0.003451576456427574
32, 0.003318916540592909
33, 0.0031870659440755844
34, 0.0030521582812070847
35, 0.0029125576838850975
36, 0.0027685496024787426
37, 0.002621609251946211
38, 0.0024739643558859825
39, 0.0023285020142793655
40, 0.0021881074644625187
41, 0.002054935321211815
42, 0.0019309082999825478
43, 0.0018171265255659819
44, 0.0017139915144070983
45, 0.0016213874332606792
46, 0.0015386426821351051
47, 0.0014649704098701477
48, 0.0013992273015901446
49, 0.0013401249889284372
50, 0.0012866341276094317
51, 0.0012376452796161175
52, 0.0011923774145543575
53, 0.001150287571363151
54, 0.0011107715545222163
55, 0.0010736397234722972
56, 0.0010387531947344542
57, 0.0010058814659714699
58, 0.0009750196477398276
59, 0.000946087937336415
60, 0.0009191675926558673
61, 0.000894096854608506
62, 0.0008708162931725383
63, 0.0008492018096148968
64, 0.0008291335543617606
65, 0.0008105716551654041
66, 0.0007932683220133185
67, 0.0007771750679239631
68, 0.0007621257100254297
69, 0.0007481003412976861
70, 0.0007349209627136588
71, 0.000722574011888355
72, 0.0007109767757356167
73, 0.000700057833455503
74, 0.0006898033316247165
75, 0.0006801459821872413
76, 0.0006710948655381799
77, 0.0006625649402849376
78, 0.0006545586511492729
79, 0.0006470604566857219
80, 0.0006400583079084754
81, 0.0006334796198643744
82, 0.0006273639155551791
83, 0.0006215921021066606
84, 0.0006162570789456367
85, 0.00061127042863518
86, 0.0006066517671570182
87, 0.0006022966699674726
88, 0.0005982824950478971
89, 0.0005945258308202028
90, 0.0005910597974434495
91, 0.0005878392839804292
92, 0.0005848660948686302
93, 0.0005820998921990395
94, 0.0005795618053525686
95, 0.0005772418808192015
96, 0.0005750599666498601
97, 0.0005730920238420367
98, 0.0005712840356864035
99, 0.0005696165026165545
100, 0.0005681519396603107
101, 0.0005667994846589863
102, 0.0005655821296386421
103, 0.0005645080818794668
104, 0.00056352315004915
105, 0.0005626552156172693
106, 0.000561911438126117
107, 0.0005612524691969156
108, 0.0005606827908195555
109, 0.0005601960583589971
110, 0.0005597806884907186
111, 0.000559447449631989
112, 0.0005591767840087414
113, 0.0005589608335867524
114, 0.0005587741616182029
115, 0.0005586709594354033
116, 0.0005585736944340169
117, 0.0005585162434726954
118, 0.0005584924947470427
119, 0.0005584812024608254
0 2.424445152282715 0.05 7.663739204406738
1 2.266749143600464 0.05 6.6991987228393555
2 2.101273536682129 0.05 5.756801128387451
3 1.904557228088379 0.05 4.729377746582031
4 1.623445987701416 0.05 3.436305046081543
5 1.2376641035079956 0.05 1.9972002506256104
6 0.802580714225769 0.05 0.8398339748382568
7 0.5767072439193726 0.05 0.4336375296115875
8 0.4742009937763214 0.05 0.29318442940711975
9 0.39287689328193665 0.05 0.20124682784080505

 10%|███████████                                                                                                    | 1/10 [00:40<06:04, 40.51s/it]
0, 0.1123598963022232
1, 0.1123598963022232
2, 0.10478764027357101
3, 0.09046938270330429
4, 0.07124536484479904
5, 0.05020025372505188
6, 0.03146938979625702
7, 0.020329512655735016
8, 0.014867104589939117
9, 0.012927398085594177
10, 0.012793667614459991
11, 0.013351617380976677
12, 0.013997368514537811
13, 0.014460481703281403
14, 0.014654306694865227
15, 0.014586440287530422
16, 0.014303088188171387
17, 0.013861849904060364
18, 0.013317473232746124
19, 0.012711085379123688
20, 0.012072051875293255
21, 0.01142148207873106
22, 0.010772855952382088
23, 0.010135783813893795
24, 0.009518997743725777
25, 0.00892928522080183
26, 0.008373691700398922
27, 0.007857752963900566
28, 0.007386021316051483
29, 0.0069589270278811455
30, 0.006577083840966225
31, 0.006237667053937912
32, 0.005935078486800194
33, 0.005664452910423279
34, 0.005419913679361343
35, 0.005196147598326206
36, 0.004988693632185459
37, 0.0047940886579453945
38, 0.004610372241586447
39, 0.004436504561454058
40, 0.004271578975021839
41, 0.004115215502679348
42, 0.003967239521443844
43, 0.003827917156741023
44, 0.0036974316462874413
45, 0.0035761776380240917
46, 0.0034638321958482265
47, 0.003360087750479579
48, 0.0032647298648953438
49, 0.003177304519340396
50, 0.00309734302572906
51, 0.0030240300111472607
52, 0.0029567847959697247
53, 0.002894857432693243
54, 0.002837464213371277
55, 0.0027838738169521093
56, 0.0027337316423654556
57, 0.002686662133783102
58, 0.0026424266397953033
59, 0.0026007748674601316
60, 0.0025614730548113585
61, 0.0025243558920919895
62, 0.0024892198853194714
63, 0.002455872716382146
64, 0.002424243837594986
65, 0.0023943788837641478
66, 0.0023661181330680847
67, 0.0023394066374748945
68, 0.0023142406716942787
69, 0.002290465636178851
70, 0.0022680272813886404
71, 0.002246897667646408
72, 0.002226848853752017
73, 0.0022079520858824253
74, 0.0021900867577642202
75, 0.0021731480956077576
76, 0.0021571617107838392
77, 0.0021420237608253956
78, 0.0021276986226439476
79, 0.0021140885073691607
80, 0.0021012555807828903
81, 0.0020890638697892427
82, 0.0020775410812348127
83, 0.002066662535071373
84, 0.002056384924799204
85, 0.0020467033609747887
86, 0.0020375321619212627
87, 0.002028924413025379
88, 0.00202082097530365
89, 0.002013174584135413
90, 0.0020060779061168432
91, 0.0019993544556200504
92, 0.0019930843263864517
93, 0.0019872449338436127
94, 0.0019818139262497425
95, 0.001976774074137211
96, 0.0019721020944416523
97, 0.0019678007811307907
98, 0.001963839866220951
99, 0.0019602105021476746
100, 0.0019568614661693573
101, 0.001953881001099944
102, 0.0019511161372065544
103, 0.0019486767705529928
104, 0.001946456148289144
105, 0.001944511430338025
106, 0.0019427656661719084
107, 0.001941286725923419
108, 0.0019399640150368214
109, 0.0019388491054996848
110, 0.0019378939177840948
111, 0.0019370935624465346
112, 0.0019364863401278853
113, 0.0019360207952558994
114, 0.0019356419797986746
115, 0.0019353220704942942
116, 0.001935117645189166
117, 0.0019349893555045128
118, 0.0019349243957549334
119, 0.0019348908681422472
0 2.7283902168273926 0.05 8.135688781738281
1 2.5657055377960205 0.05 7.194406032562256
2 2.3934359550476074 0.05 6.2607293128967285
3 2.200481414794922 0.05 5.291962623596191
4 1.9529742002487183 0.05 4.168447971343994
5 1.5828580856323242 0.05 2.738201141357422
6 1.1739344596862793 0.05 1.506152629852295
7 0.8749712109565735 0.05 0.8366982936859131
8 0.7087469100952148 0.05 0.5489890575408936
9 0.597446620464325 0.05 0.390103280544281

 20%|██████████████████████▏                                                                                        | 2/10 [01:20<05:22, 40.33s/it]
0, 0.09775816649198532
1, 0.09775816649198532
2, 0.09261538833379745
3, 0.08272592723369598
4, 0.06901427358388901
5, 0.053106680512428284
6, 0.037517767399549484
7, 0.026797039434313774
8, 0.02014802396297455
9, 0.016248025000095367
10, 0.013916393741965294
11, 0.012369389645755291
12, 0.011172613129019737
13, 0.010127291083335876
14, 0.009166247211396694
15, 0.008281723596155643
16, 0.00748153030872345
17, 0.006771753542125225
18, 0.006151700392365456
19, 0.005618847906589508
20, 0.005170096643269062
21, 0.004803367890417576
22, 0.004513248335570097
23, 0.0042902082204818726
24, 0.00411885604262352
25, 0.003980632405728102
26, 0.003856030059978366
27, 0.0037291739135980606
28, 0.0035900238435715437
29, 0.0034343614242970943
30, 0.00326338317245245
31, 0.003081842791289091
32, 0.0028973170556128025
33, 0.0027173757553100586
34, 0.002547363517805934
35, 0.0023912370670586824
36, 0.002250883961096406
37, 0.0021267090924084187
38, 0.0020172279328107834
39, 0.0019207330187782645
40, 0.0018353861523792148
41, 0.001758971600793302
42, 0.0016894310247153044
43, 0.0016250968910753727
44, 0.0015644845552742481
45, 0.0015066330088302493
46, 0.0014510712353512645
47, 0.0013975780457258224
48, 0.001346180564723909
49, 0.0012970257084816694
50, 0.0012503701727837324
51, 0.001206492423079908
52, 0.001165561843663454
53, 0.0011274892603978515
54, 0.001091912854462862
55, 0.0010587016586214304
56, 0.001027498277835548
57, 0.0009980453178286552
58, 0.0009701199596747756
59, 0.0009437076514586806
60, 0.0009186707902699709
61, 0.0008949313778430223
62, 0.0008724802173674107
63, 0.0008513019420206547
64, 0.0008313367143273354
65, 0.0008125142194330692
66, 0.0007947720587253571
67, 0.0007781251333653927
68, 0.0007625007419846952
69, 0.000747827987652272
70, 0.0007340691518038511
71, 0.0007211521151475608
72, 0.0007090665167197585
73, 0.0006977039156481624
74, 0.0006870630895718932
75, 0.0006770798936486244
76, 0.0006677086930721998
77, 0.0006589106633327901
78, 0.0006506777717731893
79, 0.0006429312634281814
80, 0.0006356712547130883
81, 0.000628864043392241
82, 0.0006224733078852296
83, 0.000616459408774972
84, 0.0006108176312409341
85, 0.000605545355938375
86, 0.000600600556936115
87, 0.0005959683330729604
88, 0.0005916344234719872
89, 0.0005875860806554556
90, 0.0005838107317686081
91, 0.0005802949890494347
92, 0.0005770596908405423
93, 0.0005740156630054116
94, 0.0005712233833037317
95, 0.0005686639342457056
96, 0.0005662867915816605
97, 0.0005641027237288654
98, 0.0005620917654596269
99, 0.0005602696328423917
100, 0.0005586132174357772
101, 0.0005571097135543823
102, 0.0005557660479098558
103, 0.0005545505555346608
104, 0.0005534790107049048
105, 0.0005525003653019667
106, 0.0005516525125131011
107, 0.0005509331822395325
108, 0.000550295109860599
109, 0.000549761054571718
110, 0.0005493084318004549
111, 0.0005489117465913296
112, 0.0005486164009198546
113, 0.0005483702407218516
114, 0.0005481772823259234
115, 0.0005480385152623057
116, 0.0005479343235492706
117, 0.0005478807142935693
118, 0.0005478453240357339
119, 0.0005478390376083553
0 2.5335772037506104 0.05 8.796038627624512
1 2.3796513080596924 0.05 7.759710311889648
2 2.180955171585083 0.05 6.517969131469727
3 1.8428758382797241 0.05 4.653835296630859
4 1.4210083484649658 0.05 2.7670187950134277
5 1.0222163200378418 0.05 1.4318729639053345
6 0.761319100856781 0.05 0.7942409515380859
7 0.5792713761329651 0.05 0.45981478691101074
8 0.4755015969276428 0.05 0.3098295331001282
9 0.4069557785987854 0.05 0.22694116830825806

 30%|█████████████████████████████████▎                                                                             | 3/10 [02:01<04:42, 40.34s/it]
0, 0.09936030954122543
1, 0.09936030954122543
2, 0.09243916720151901
3, 0.07954061031341553
4, 0.0627114474773407
5, 0.045156024396419525
6, 0.030595548450946808
7, 0.022508811205625534
8, 0.018519047647714615
9, 0.016693418845534325
10, 0.015816902741789818
11, 0.01524457335472107
12, 0.014696712605655193
13, 0.01409098505973816
14, 0.013438175432384014
15, 0.012776206247508526
16, 0.012141774408519268
17, 0.01155821979045868
18, 0.011036708950996399
19, 0.010575411841273308
20, 0.010165026411414146
21, 0.009795308113098145
22, 0.009456083178520203
23, 0.009137498214840889
24, 0.008833561092615128
25, 0.008539305068552494
26, 0.008253785781562328
27, 0.007977823726832867
28, 0.007712503895163536
29, 0.007458258420228958
30, 0.007215559016913176
31, 0.0069855982437729836
32, 0.00676862895488739
33, 0.0065645985305309296
34, 0.006372891366481781
35, 0.006192795932292938
36, 0.00602312758564949
37, 0.005863386206328869
38, 0.0057133957743644714
39, 0.005572590045630932
40, 0.005439970642328262
41, 0.005314925219863653
42, 0.005196773912757635
43, 0.005085083656013012
44, 0.0049794018268585205
45, 0.004879426211118698
46, 0.0047850641421973705
47, 0.0046959626488387585
48, 0.004611659329384565
49, 0.00453187245875597
50, 0.004456065129488707
51, 0.004383482038974762
52, 0.00431395135819912
53, 0.004247546195983887
54, 0.004184045363217592
55, 0.004123146645724773
56, 0.0040646884590387344
57, 0.004008276853710413
58, 0.003953985869884491
59, 0.0039017698727548122
60, 0.0038517776411026716
61, 0.003803856438025832
62, 0.003757832106202841
63, 0.0037138282787054777
64, 0.003671657992526889
65, 0.0036311503499746323
66, 0.0035921770613640547
67, 0.0035547586157917976
68, 0.003518756479024887
69, 0.003484127577394247
70, 0.0034508442040532827
71, 0.0034189443103969097
72, 0.0033882013522088528
73, 0.0033585932105779648
74, 0.0033300970681011677
75, 0.0033027275931090117
76, 0.0032764251809567213
77, 0.003251215210184455
78, 0.003227162640541792
79, 0.0032041375525295734
80, 0.0031822160817682743
81, 0.0031612380407750607
82, 0.0031413647811859846
83, 0.003122329246252775
84, 0.003104211762547493
85, 0.0030870221089571714
86, 0.0030707307159900665
87, 0.0030552286189049482
88, 0.0030405453871935606
89, 0.003026670543476939
90, 0.003013578010722995
91, 0.0030012275092303753
92, 0.002989682136103511
93, 0.0029788175597786903
94, 0.002968687331303954
95, 0.0029591689817607403
96, 0.0029503467958420515
97, 0.0029421206563711166
98, 0.0029345043003559113
99, 0.0029275771230459213
100, 0.002921160077676177
101, 0.0029153241775929928
102, 0.002909996546804905
103, 0.0029052486643195152
104, 0.0029009159188717604
105, 0.0028971524443477392
106, 0.0028937412425875664
107, 0.002890758216381073
108, 0.002888198010623455
109, 0.0028859791345894337
110, 0.002884163288399577
111, 0.002882581204175949
112, 0.002881348133087158
113, 0.0028803215827792883
114, 0.0028795390389859676
115, 0.0028789665084332228
116, 0.002878595609217882
117, 0.0028783194720745087
118, 0.002878171857446432
119, 0.0028780957218259573
0 2.726654529571533 0.05 8.842544555664062
1 2.5734245777130127 0.05 7.876619338989258
2 2.4147636890411377 0.05 6.93531608581543
3 2.238783597946167 0.05 5.9613037109375
4 2.0208096504211426 0.05 4.856996536254883
5 1.6915708780288696 0.05 3.403278112411499
6 1.2045584917068481 0.05 1.7257299423217773
7 0.8701342940330505 0.05 0.9005122184753418
8 0.7088845372200012 0.05 0.5976790189743042
9 0.5986932516098022 0.05 0.4263102412223816

 40%|████████████████████████████████████████████▍                                                                  | 4/10 [02:41<04:01, 40.29s/it]
0, 0.12813778221607208
1, 0.12813778221607208
2, 0.12089893221855164
3, 0.10838198661804199
4, 0.09137274324893951
5, 0.07178556174039841
6, 0.05270402133464813
7, 0.03926677629351616
8, 0.030530262738466263
9, 0.02512197196483612
10, 0.02169940620660782
11, 0.019480857998132706
12, 0.017901651561260223
13, 0.016622435301542282
14, 0.015554104000329971
15, 0.014622683636844158
16, 0.01374869979918003
17, 0.012942242436110973
18, 0.012187208980321884
19, 0.011488488875329494
20, 0.010823482647538185
21, 0.010221312753856182
22, 0.009673968888819218
23, 0.009188167750835419
24, 0.008748495019972324
25, 0.00835917703807354
26, 0.008016182109713554
27, 0.00771523779258132
28, 0.007453038357198238
29, 0.007210833486169577
30, 0.006980267819017172
31, 0.006762669421732426
32, 0.006555297877639532
33, 0.006356474012136459
34, 0.0061527639627456665
35, 0.005962270312011242
36, 0.0057744188234210014
37, 0.005599094554781914
38, 0.005424637347459793
39, 0.005255585536360741
40, 0.005087700672447681
41, 0.004932416137307882
42, 0.004779438022524118
43, 0.0046414947137236595
44, 0.004512271843850613
45, 0.004383334890007973
46, 0.004270590376108885
47, 0.004154342692345381
48, 0.004047188442200422
49, 0.003943644464015961
50, 0.003843578277155757
51, 0.0037558861076831818
52, 0.003661848371848464
53, 0.0035822256468236446
54, 0.0034944869112223387
55, 0.0034185717813670635
56, 0.003341765608638525
57, 0.003269861452281475
58, 0.003205940593034029
59, 0.0031385920010507107
60, 0.0030797352083027363
61, 0.0030174735002219677
62, 0.00295766512863338
63, 0.002902653766795993
64, 0.002850196324288845
65, 0.002801698399707675
66, 0.002748900791630149
67, 0.0027065789327025414
68, 0.0026623238809406757
69, 0.00262160855345428
70, 0.0025809172075241804
 40%|████████████████████████████████████████████▍                                                                  | 4/10 [03:05<04:38, 46.34s/it]
Traceback (most recent call last):
  File "/home/icl2/khlee/InstaFlow/code/main_reconstruction_exp.py", line 166, in <module>
    main()
  File "/home/icl2/khlee/InstaFlow/code/main_reconstruction_exp.py", line 110, in main
    original_image, recon_image, diff_image, original_latents_visualized, recon_latents_visualized, diff_latents_visualized, error_TOT, error_OTO, error_middle, output_loss, inf_time, inv_time, seed = single_exp(seed, prompt, inversion_prompt,
  File "/home/icl2/anaconda3/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/icl2/khlee/InstaFlow/code/main_reconstruction_exp.py", line 47, in single_exp
    recon_images, recon_zo, recon_latents, output_loss = insta_pipe.exact_inversion(
  File "/home/icl2/khlee/InstaFlow/code/pipeline_rf.py", line 923, in exact_inversion
    latents = self.edcorrector(image, decoder_inv_steps=decoder_inv_steps, verbose=verbose)
  File "/home/icl2/khlee/InstaFlow/code/pipeline_rf.py", line 1278, in edcorrector
    print(f"{i}, {loss.item()}")
KeyboardInterrupt
72, 0.0025084938388317823