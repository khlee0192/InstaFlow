  0%|                                                                                                                                                                                                                                                                     | 0/100 [00:00<?, ?it/s]/home/icl2/anaconda3/lib/python3.10/site-packages/torch/cuda/memory.py:330: FutureWarning: torch.cuda.reset_max_memory_allocated now calls torch.cuda.reset_peak_memory_stats, which resets /all/ peak memory stats.
  warnings.warn(
tensor(0.7582, device='cuda:0') 117.0625 119.875
tensor(0.7580, device='cuda:0') 117.0625 119.875
tensor(0.7578, device='cuda:0') 117.0625 119.875
tensor(0.7574, device='cuda:0') 117.0625 119.875
tensor(0.7571, device='cuda:0') 117.0625 119.875
tensor(0.7565, device='cuda:0') 117.0625 119.875
tensor(0.7560, device='cuda:0') 117.0625 119.875
tensor(0.7553, device='cuda:0') 117.0625 119.875
tensor(0.7549, device='cuda:0') 117.0625 119.875
tensor(0.7543, device='cuda:0') 117.0625 119.875
tensor(0.7535, device='cuda:0') 117.0625 119.875
tensor(0.7533, device='cuda:0') 117.0625 119.875
tensor(0.7526, device='cuda:0') 117.0625 119.875
tensor(0.7519, device='cuda:0') 117.0625 119.875
tensor(0.7513, device='cuda:0') 117.0625 119.875
tensor(0.7504, device='cuda:0') 117.0625 119.875
tensor(0.7498, device='cuda:0') 117.0625 119.875
tensor(0.7495, device='cuda:0') 117.0625 119.875
tensor(0.7488, device='cuda:0') 117.0625 119.875
tensor(0.7482, device='cuda:0') 117.0625 119.8125
tensor(0.7476, device='cuda:0') 117.0625 119.875
tensor(0.7471, device='cuda:0') 117.0625 119.875
tensor(0.7465, device='cuda:0') 117.0625 119.875
tensor(0.7456, device='cuda:0') 117.0625 119.875
tensor(0.7454, device='cuda:0') 117.0625 119.875
tensor(0.7446, device='cuda:0') 117.0625 119.875
tensor(0.7442, device='cuda:0') 117.0625 119.875
tensor(0.7435, device='cuda:0') 117.0625 119.875
tensor(0.7428, device='cuda:0') 117.0625 119.875
tensor(0.7425, device='cuda:0') 117.0625 119.875
tensor(0.7420, device='cuda:0') 117.0625 119.875
tensor(0.7414, device='cuda:0') 117.0625 119.875
tensor(0.7408, device='cuda:0') 117.0625 119.875
tensor(0.7407, device='cuda:0') 117.0625 119.875
tensor(0.7399, device='cuda:0') 117.0625 119.875
tensor(0.7393, device='cuda:0') 117.0625 119.875
tensor(0.7390, device='cuda:0') 117.0625 119.875
tensor(0.7383, device='cuda:0') 117.0625 119.875
tensor(0.7374, device='cuda:0') 117.0625 119.875
tensor(0.7370, device='cuda:0') 117.0625 119.875
tensor(0.7364, device='cuda:0') 117.0625 119.875
tensor(0.7360, device='cuda:0') 117.0625 119.875
tensor(0.7353, device='cuda:0') 117.0625 119.8125
tensor(0.7348, device='cuda:0') 117.0625 119.8125
tensor(0.7343, device='cuda:0') 117.0625 119.8125
tensor(0.7335, device='cuda:0') 117.0625 119.875
tensor(0.7330, device='cuda:0') 117.0625 119.875
tensor(0.7324, device='cuda:0') 117.0625 119.8125
tensor(0.7319, device='cuda:0') 117.0625 119.875
tensor(0.7317, device='cuda:0') 117.0625 119.875
tensor(0.7310, device='cuda:0') 117.0625 119.875
tensor(0.7307, device='cuda:0') 117.0625 119.875
tensor(0.7299, device='cuda:0') 117.0625 119.8125
tensor(0.7294, device='cuda:0') 117.0625 119.8125
tensor(0.7290, device='cuda:0') 117.0625 119.8125
tensor(0.7286, device='cuda:0') 117.0625 119.8125
tensor(0.7279, device='cuda:0') 117.0625 119.8125
tensor(0.7276, device='cuda:0') 117.0625 119.8125
tensor(0.7268, device='cuda:0') 117.0625 119.8125
tensor(0.7264, device='cuda:0') 117.0625 119.8125
tensor(0.7257, device='cuda:0') 117.0625 119.8125
tensor(0.7253, device='cuda:0') 117.0625 119.8125
tensor(0.7246, device='cuda:0') 117.0625 119.8125
tensor(0.7239, device='cuda:0') 117.0625 119.8125
tensor(0.7237, device='cuda:0') 117.0625 119.8125
tensor(0.7233, device='cuda:0') 117.0625 119.8125
tensor(0.7225, device='cuda:0') 117.0625 119.8125
tensor(0.7220, device='cuda:0') 117.0625 119.8125
tensor(0.7217, device='cuda:0') 117.0625 119.8125
tensor(0.7217, device='cuda:0') 117.0625 119.8125
tensor(0.7210, device='cuda:0') 117.0625 119.8125
tensor(0.7201, device='cuda:0') 117.0625 119.8125
tensor(0.7197, device='cuda:0') 117.0625 119.8125
tensor(0.7190, device='cuda:0') 117.0625 119.8125
tensor(0.7190, device='cuda:0') 117.0625 119.8125
tensor(0.7179, device='cuda:0') 117.0625 119.8125
tensor(0.7177, device='cuda:0') 117.0625 119.8125
tensor(0.7169, device='cuda:0') 117.0625 119.8125
tensor(0.7169, device='cuda:0') 117.0625 119.8125
tensor(0.7162, device='cuda:0') 117.0625 119.8125
tensor(0.7156, device='cuda:0') 117.0625 119.8125
tensor(0.7150, device='cuda:0') 117.0625 119.8125
tensor(0.7145, device='cuda:0') 117.0625 119.8125
tensor(0.7135, device='cuda:0') 117.0625 119.8125
tensor(0.7130, device='cuda:0') 117.0625 119.8125
tensor(0.7127, device='cuda:0') 117.0625 119.8125
tensor(0.7122, device='cuda:0') 117.0625 119.8125
tensor(0.7115, device='cuda:0') 117.0625 119.8125
tensor(0.7106, device='cuda:0') 117.0625 119.8125
tensor(0.7101, device='cuda:0') 117.0625 119.8125
tensor(0.7091, device='cuda:0') 117.0625 119.8125
tensor(0.7086, device='cuda:0') 117.125 119.8125
tensor(0.7077, device='cuda:0') 117.125 119.8125
tensor(0.7069, device='cuda:0') 117.125 119.8125
tensor(0.7061, device='cuda:0') 117.125 119.8125
tensor(0.7062, device='cuda:0') 117.125 119.8125
tensor(0.7053, device='cuda:0') 117.125 119.8125
tensor(0.7047, device='cuda:0') 117.125 119.8125
tensor(0.7040, device='cuda:0') 117.125 119.8125
tensor(0.7034, device='cuda:0') 117.125 119.8125
tensor(0.7028, device='cuda:0') 117.125 119.8125
tensor(0.7024, device='cuda:0') 117.125 119.8125
tensor(0.7016, device='cuda:0') 117.125 119.8125
tensor(0.7009, device='cuda:0') 117.125 119.8125
tensor(0.6996, device='cuda:0') 117.125 119.8125
tensor(0.6996, device='cuda:0') 117.125 119.8125
tensor(0.6987, device='cuda:0') 117.125 119.8125
tensor(0.6979, device='cuda:0') 117.125 119.8125
tensor(0.6980, device='cuda:0') 117.125 119.8125
tensor(0.6971, device='cuda:0') 117.125 119.8125
tensor(0.6963, device='cuda:0') 117.125 119.8125
tensor(0.6956, device='cuda:0') 117.125 119.8125
tensor(0.6952, device='cuda:0') 117.125 119.8125
  0%|                                                                                                                                                                                                                                                                     | 0/100 [01:43<?, ?it/s]
Traceback (most recent call last):
  File "/home/icl2/anaconda3/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/icl2/anaconda3/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/icl2/.vscode/extensions/ms-python.python-2024.4.1/python_files/lib/python/debugpy/adapter/../../debugpy/launcher/../../debugpy/__main__.py", line 39, in <module>
    cli.main()
  File "/home/icl2/.vscode/extensions/ms-python.python-2024.4.1/python_files/lib/python/debugpy/adapter/../../debugpy/launcher/../../debugpy/../debugpy/server/cli.py", line 430, in main
    run()
  File "/home/icl2/.vscode/extensions/ms-python.python-2024.4.1/python_files/lib/python/debugpy/adapter/../../debugpy/launcher/../../debugpy/../debugpy/server/cli.py", line 284, in run_file
    runpy.run_path(target, run_name="__main__")
  File "/home/icl2/.vscode/extensions/ms-python.python-2024.4.1/python_files/lib/python/debugpy/_vendored/pydevd/_pydevd_bundle/pydevd_runpy.py", line 321, in run_path
    return _run_module_code(code, init_globals, run_name,
  File "/home/icl2/.vscode/extensions/ms-python.python-2024.4.1/python_files/lib/python/debugpy/_vendored/pydevd/_pydevd_bundle/pydevd_runpy.py", line 135, in _run_module_code
    _run_code(code, mod_globals, init_globals,
  File "/home/icl2/.vscode/extensions/ms-python.python-2024.4.1/python_files/lib/python/debugpy/_vendored/pydevd/_pydevd_bundle/pydevd_runpy.py", line 124, in _run_code
    exec(code, run_globals)
  File "/home/icl2/khlee/InstaFlow/code/main_new_algorithm.py", line 295, in <module>
    main()
  File "/home/icl2/khlee/InstaFlow/code/main_new_algorithm.py", line 212, in main
    original_image, recon_image, diff_image, original_latents_visualized, recon_latents_visualized, diff_latents_visualized, error_TOT, error_OTO, error_middle, output_loss, peak_gpu_allocated, inf_time, inv_time, seed, extra_outputs, extra_outputs_another, another_output = single_exp(seed, prompt, inversion_prompt,
  File "/home/icl2/anaconda3/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/icl2/khlee/InstaFlow/code/main_new_algorithm.py", line 48, in single_exp
    recon_images, recon_zo, recon_latents, output_loss, peak_gpu_allocated, dec_inv_time, extra_outputs, extra_outputs_another, another_output = insta_pipe.exact_inversion(
  File "/home/icl2/khlee/InstaFlow/code/pipeline_rf.py", line 955, in exact_inversion
    latents, extra_outputs, extra_outputs_another, another_output = self.dec_direct(image, latents, test_beta=test_beta, adam=False, decoder_inv_steps=decoder_inv_steps, decoder_lr=decoder_lr, verbose=verbose, use_float=decoder_use_float)
  File "/home/icl2/anaconda3/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/icl2/khlee/InstaFlow/code/pipeline_rf.py", line 1488, in dec_direct
    cocoercivity_rate = inner_product / torch.norm(EDz_i.float()-EDz_comp.float())**2
  File "/home/icl2/anaconda3/lib/python3.10/site-packages/torch/_tensor.py", line 728, in norm
    def norm(
  File "_pydevd_bundle/pydevd_cython.pyx", line 1457, in _pydevd_bundle.pydevd_cython.SafeCallWrapper.__call__
  File "_pydevd_bundle/pydevd_cython.pyx", line 1758, in _pydevd_bundle.pydevd_cython.ThreadTracer.__call__
  File "/home/icl2/.vscode/extensions/ms-python.python-2024.4.1/python_files/lib/python/debugpy/_vendored/pydevd/_pydev_bundle/pydev_is_thread_alive.py", line 9, in is_thread_alive
    def is_thread_alive(t):
KeyboardInterrupt
Exception ignored in: <module 'threading' from '/home/icl2/anaconda3/lib/python3.10/threading.py'>
Traceback (most recent call last):
  File "/home/icl2/anaconda3/lib/python3.10/threading.py", line 1567, in _shutdown
    lock.acquire()
